@model TapHoa.Data.Diachi

@{
    ViewData["Title"] = "Thêm địa chỉ mới";
    Layout = "~/Views/Shared/_Layout.cshtml"; 
}

<h1>Thêm địa chỉ mới</h1>

<form asp-action="Create" method="post" style="max-width: 600px; margin: auto;">
    <div class="form-group">
        <label for="Tennguoinhan">Họ và tên</label>
        <input asp-for="Tennguoinhan" class="form-control" id="Tennguoinhan" required />
    </div>
    <div class="form-group">
        <label for="Sdt">Số điện thoại</label>
        <input asp-for="Sdt" class="form-control" id="Sdt" required />
    </div>
    <div class="form-group">
        <label for="Province">Tỉnh/Thành phố</label>
        <select id="Province" class="form-control"></select>
    </div>
    <div class="form-group">
        <label for="District">Quận/Huyện</label>
        <select id="District" class="form-control"></select>
    </div>
    <div class="form-group">
        <label for="Ward">Phường/Xã</label>
        <select id="Ward" class="form-control"></select>
    </div>
    <div class="form-group">
        <label for="Diachi1">Địa chỉ cụ thể</label>
        <input asp-for="Diachi1" class="form-control" id="Diachi1" required />
    </div>
    <button type="submit" class="btn btn-primary">Hoàn thành</button>
    <a asp-action="Index" class="btn btn-secondary">Trở lại</a>
</form>

@section Scripts {
    <script>
        $(document).ready(function () {
            // Lấy danh sách tỉnh/thành phố
            $.getJSON('/api/AddressApi/GetProvinces', function (data) {
                $('#Province').empty().append('<option>Chọn Tỉnh/Thành phố</option>');
                data.forEach(function (item) {
                    $('#Province').append('<option value="' + item.id + '">' + item.name + '</option>');
                });
            });

            // Lấy danh sách quận/huyện theo tỉnh/thành phố
            $('#Province').change(function () {
                var provinceId = $(this).val();
                $.getJSON('/api/AddressApi/GetDistricts/' + provinceId, function (data) {
                    $('#District').empty().append('<option>Chọn Quận/Huyện</option>');
                    data.forEach(function (item) {
                        $('#District').append('<option value="' + item.id + '">' + item.name + '</option>');
                    });
                });
            });

            // Lấy danh sách phường/xã theo quận/huyện
            $('#District').change(function () {
                var districtId = $(this).val();
                $.getJSON('/api/AddressApi/GetWards/' + districtId, function (data) {
                    $('#Ward').empty().append('<option>Chọn Phường/Xã</option>');
                    data.forEach(function (item) {
                        $('#Ward').append('<option value="' + item.id + '">' + item.name + '</option>');
                    });
                });
            });
        });
    </script>
}